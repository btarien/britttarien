<!DOCTYPE html>
<html>
<head>
  <title>Britt Tarien - Row Project</title>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

  <header class="container">
      <nav class="text-right">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="resume.html">Resume</a></li>
          <li><a href="portfolio.html">Portfolio</a></li>
        </ul>
      </nav>
  </header>

  <body>
    <div class="container">
      <h1 class = "title"> Row Project </h1>
      <h2> The Goal </h2>
      <p>
        We are working with Hegemony Tech, a startup that is building an app called SwingRow that tracks various metrics of a competition rowboat. By generating data, rowers and their coaches can gain more insight into ways to improve their rowing technique. Since smartphones are already ubiquitous in today's society, Hegemony aims to build an app that is readily available and cheap for rowers at any level. All sensors and computations must therefore be self-contained within the smartphone. For now, we focus on the iPhone framework and on a single-rower configuration. Later, Hegemony hopes to extrapolate this to other boat configurations and smartphone platforms.
      </p>

      <h2> The Problem </h2>
      <p>
        Rowers are primarily concerned with maximizing the speed of their boat and the distance they can cover in each stroke. For this reason, we focus on increasing the accuracy of these two metrics. The GPS from the iPhone samples about once every three seconds, so there is not enough resolution to see what happens within a stroke (which takes about 2 seconds). The accelerometer has an acceptable sampling frequency of 100 Hz, but since rowers are interested in speed and position, it must be integrated or double integrated which introduces a steep low-frequency drift.
      </p>
      <div class="row">
        <div class="col-sm-6">
          <img src="once_integrated.png" class="img-thumbnail" width=75%>
        </div>
        <div class="col-sm-6">
          <img src="twice_integrated.png" class="img-thumbnail" width=75%>
        </div>
      </div>

      <h2> The Solution </h2>
      <p>
        It turns out that the GPS and accelerometer signals are quite complementary to each other. The GPS maintains a relatively accurate average speed over many strokes but does not give the resolution within a single stroke. The accelerometer, on the other hand, provides high resolution information but its average speed drifts off very quickly. We have built two filters, a complementary and a Kalman filter, which combine the two data streams to create a more accurate estimate of distance and speed.
      </p>

      <h3> Complementary Filter </h3>
      <div class="row">
        <div class = "col-sm-6">
          <p>
            The integrated acceleration is high-pass filtered to get rid of the low-frequency drift, but keep the high-frequency resolution within each stroke. The GPS is low-pass filtered to get rid of any high-frequency noise. These two signals are then summed together.
          </p>
          <p>
            To get a more accurate result, we apply a linear extrapolation of the previous two GPS position points to get a more accurate prediction between the 0.3 Hz data points.
          </p>
          <p>
            We use an optimization on each of our 16 data files to generate the optimal low and high cutoff frequencies. We are then able to use the average values over all runs in the filter. With the cutoff frequencies already built in, the filter only needs the previous two data points to operate and runs in real time.
          </p>
        </div>
        <div class = "col-sm-6">
          <img src="CF.png" class="img-thumbnail" width=100% align=center>
        </div>
      </div>

      <h3> Kalman Filter </h3>
      <div class = "row">
        <div class = "col-sm-6">
          <img src="KF.png" class="img-thumbnail" width=100% align=center>
        </div>
        <div class = "col-sm-6">
        <p>
          The Kalman filter uses Bayesian statistics to estimate the trajectory of the boat. Kalman filters involve two steps: a model prediction update step and a measurement update step. For the model prediction update, we use the accelerometer data to predict where the boat will be. The GPS is used for the measurement update. The Kalman filter also provides an estimate of the covariance which tells us how accurate the estimation is.
        </p>
        <p>
          The R and Q matrices, which correspond to the sensor noise covariance and the process noise covariance respectively, are used to tune the Kalman filter. R defines how much to trust the sensors. So we set R to be 0.8 m, which we measured to be the variance in our iPhone sensor. Q defines how much to trust the model. We find Q by running an optimization, similar to the one for the cutoff frequencies in the complementary filter.
        </p>
        </div>
      </div>

      <h2> The Result </h2>
      <h3> Experimental Validation </h3>
      <p>
        We used a differential GPS system (accurate to ~3mm) to define our "ground truth" data. We simultaneously logged data on the differential GPS and the iPhone while a rower performed passes at various speeds up and down a lake. We collected data on two different rower-boat configuration: a single scull boat (one seat) with an elite rower, and a double scull boat (two seats) with a single amateur rower. These offered two very different styles of rowing, so if our filters can perform well on both, then we know they are robust.
      </p>
      <div class="row">
        <div class="col-sm-4">
          <img src="gps_mount.png" class="img-thumbnail" width=100% align=center>
          <figcaption>Differential GPS mount</figcaption>
        </div>
        <div class="col-sm-4">
          <img src="phone_mount.png" class="img-thumbnail"  align=center>
          <figcaption>iPhone mount</figcaption>
        </div>
        <div class="col-sm-4">
          <img src="map.png" class="img-thumbnail" width=100% align=center>
          <figcaption>Boat path</figcaption>
        </div>
      </div>
      <h3> Filter Results </h3>
      <div class = "row">
        <div class = "col-sm-8">
          <img src="all_filters.png" class="img-thumbnail" align=center>
        </div>
        <div class = "col-sm-4">
          <p>
            Originally, Hegemony Tech was using the raw iPhone speed (green line) to measure speed. But, with our filters, you can now see drastically improved results in both resolution and accuracy. We are able to generate results that are almost as good as a $2,000 differential GPS system, using nothing more than the sensors that are already onboard an iPhone.
          </p>
        </div>
      <div>
        <p>

          </p>
      </div>
  </body>
</html>
